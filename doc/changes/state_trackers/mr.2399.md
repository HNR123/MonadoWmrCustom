gui: Refactor GUI state tracker into a base that can be more easily re-used
and that brings in fewer dependencies.
